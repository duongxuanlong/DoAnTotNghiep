\chapter{Gom nhóm phân cấp}
\label{Chapter2}

\section{Giới thiệu}
%Giới thiệu phương pháp gom nhóm phân cấp
Gom nhóm phân cấp là kỹ thuật quan trọng trong việc phân loại nhóm. Phương pháp gom nhóm này dùng để xây dựng các nhóm thành các cấp bậc khác nhau.
Khác với phương pháp gom nhóm phân chia, kết quả có được chỉ là những đối tượng nằm ở trong các nhóm riêng biệt.
Ngoài ra, phương pháp gom nhóm phân chia cần phải xác định số lượng nhóm cần phải gom.
Gom nhóm phân cấp khắc phục được các nhược điểm của gom nhóm phân chia đồng thời cho chúng ta thấy được cấu trúc của ngữ liệu.

~\cite{Vipin-Kumar} Gom nhóm phân cấp thường được biểu diễn dưới dạng đồ thị hình cây với tên gọi là dendrogram, thể hiện mối quan hệ giữa nhóm và nhóm con.
Đồ thị này thể hiện thứ tự các nhóm được gom (hướng tiếp cận tích tụ) hoặc là tách (hướng tiếp cận phân chia). 
Cho một tập gồm các điểm 2 chiều, gom nhóm phân cấp có thể biểu diễn các nhóm lồng vào nhau hoặc dưới dạng cây phân cấp.
Hình \ref{fig:pic21} cho thấy 2 loại biểu diễn của gom nhóm phân cấp cho tập điểm 2 chiều.
Các điểm này được gom nhóm theo kỹ thuật liên kết đơn (\ref{sec:lkd}).

\begin{figure}[htp]
%\makeatletter % For spaces in paths
%\patchcmd\Gread@eps{\@inputcheck#1 }{\@inputcheck"#1"\relax}{}{}
%\makeatother
\psscalebox{1.2 1.2} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-2.21)(14.42,2.21)
\psline[linecolor=black, linewidth=0.04](0.02,2.19)(0.02,-1.81)(0.02,-1.41)
\psline[linecolor=black, linewidth=0.04](2.02,-1.81)(2.02,-0.21)(2.02,-0.21)
\psline[linecolor=black, linewidth=0.04](3.22,-0.21)(3.22,-1.81)
\psline[linecolor=black, linewidth=0.04](4.42,-1.81)(4.42,0.99)
\psline[linecolor=black, linewidth=0.04](2.02,-0.21)(3.22,-0.21)
\psline[linecolor=black, linewidth=0.04](2.82,-0.21)(2.82,-0.21)
\psline[linecolor=black, linewidth=0.04](2.82,-0.21)(2.82,0.99)(4.42,0.99)
\psline[linecolor=black, linewidth=0.04](3.62,0.99)(3.62,2.19)(0.02,2.19)
\rput[bl](0.02,-2.21){p1}
\rput[bl](2.02,-2.21){p2}
\rput[bl](3.22,-2.21){p3}
\rput[bl](4.42,-2.21){p4}
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](11.02,0.19)(3.4,2.0)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](12.02,-0.01)(2.0,1.4)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](11.42,-0.01)(1.0,1.0)
\psdots[linecolor=black, dotsize=0.2](8.82,0.99)
\psdots[linecolor=black, dotsize=0.2](10.82,0.19)
\psdots[linecolor=black, dotsize=0.2](10.82,-0.61)
\psdots[linecolor=black, dotsize=0.2](13.22,-0.21)
\rput[bl](8.82,0.19){p1}
\rput[bl](11.22,-0.61){p2}
\rput[bl](11.22,0.19){p3}
\rput[bl](12.82,-0.61){p4}
\end{pspicture}
}
\caption{Gom nhóm phân cấp với 4 điểm được biểu diễn dưới đồ thị dạng cây và đồ thị hình tròn lồng vào nhau}
\label{fig:pic21}
\end{figure}

\section{Các hướng tiếp cận}
%Các hướng tiếp cận
~\cite{Vipin-Kumar, hierarchical-clustering} Để xây dựng nên cấu trúc cây của các nhóm trong gom nhóm phân cấp, ta có hai hướng tiếp cận khác nhau. Đó là hướng tiếp cận tích tụ và hướng tiếp cận phân chia.

\subsection{Hướng tiếp cận phân chia}
%Hướng tiếp cận divisive	
%Giới thiệu
Hướng tiếp cận phân chia là một trong những cách tiếp cận của gom nhóm phân cấp.
Tuy nhiên, hướng tiếp cận này ít phổ biến hơn so với hướng tiếp cận tích tụ.
Đây là phương pháp tiếp cận gom nhóm theo cách đi từ trên xuống.
Kỹ thuật này còn có tên gọi khác là tối tiểu hóa khoảng cách của độ tương đồng đồ thị.

Kỹ thuật tối tiểu hóa khoảng cách cây của độ tương đồng đồ thị được xây dựng bắt đầu bằng một điểm bất kỳ nào của cây.
Trong những bước tiếp theo, ta sẽ tìm kiếm những cặp điểm gần nhất, $p$ và $q$ sao cho với điểm $p$ là điểm hiện đang thuộc thuộc về cây còn điểm $q$ thì không.
Ta sẽ thêm $p$ vào cây và nối cạnh giữa hai điểm $p$ và $p$.
Sau đây là thuật toán thể hiện ý tưởng trên:

\begin{algorithm}
\caption{Divisive Hierarchical Clustering Algorithm}
\label{alg:Divisive}
\begin{algorithmic}[1]
\State Compute a minimum spanning tree for the proximity graph.
\Repeat
\State Create a new cluster by breaking the link corresponding to the largest distance (smallest similarity).
\Until{Only singleton clusters remains.}
\end{algorithmic}
\end{algorithm}

Theo như ~\cite{wiki-HAC}, thuật toán gom nhóm phân cấp theo hướng phân chia có độ phức tạp rất lớn: $O(2^n)$.

%Phương pháp này bắt đầu từ việc quan sát tất cả chỉ trong một phân nhóm, và khi di chuyển xuống sẽ tách dần dần thành các phân nhóm con.
%Quá trình gộp và tách thường sẽ tốn nhiều chi phí cho thuật toán.
%Khác với hướng tiếp cận tích tụ, hướng tiếp cận phân chia có độ phức tạp lớn hơn, $O(2^n)$.
		
%Ví dụ
		
\subsection{Hướng tiếp cận tích tụ}
%Hướng tiếp cận agglomerative
%Giới thiệu
Gom nhóm phân cấp theo hướng tích tụ là hướng tiếp cận phổ biến nhất trong gom nhóm phân cấp.
Phương pháp này bắt đầu bằng việc xem mỗi điểm như là một nhóm, sau đó dần dần gom các nhóm đơn lẻ này lại với nhau thành nhóm lớn hơn và cho đến khi chỉ còn lại một nhóm duy nhất.
Sau đây là thuật toán mô tả quá trình gom nhóm theo hướng tích tụ.

\begin{algorithm}
\caption{Basic Agglomerative Hierarchical Clustering Algorithm}\label{agl:agglomerative}
\begin{algorithmic}[1]
\State Compute the proximity graph, if neccessary.
\Repeat
\State Merge the closest two clusters.
\State Update the proximity matrix to reflect the proximity between the new cluster and the original clusters.
\Until{Only one cluster remains.}
\end{algorithmic}
\end{algorithm}

Theo như ~\cite{wiki-HAC}, thuật toán gom nhóm phân cấp theo hướng tích tụ có độ phức tạp là $O(n^2\log(n))$.

%Hướng tiếp cận tích tụ là một trong những cách tiếp cận của gom nhóm phân cấp.
%Đây là phương pháp tiếp cận gom nhóm theo cách đi từ dưới lên.
%Phương pháp này bắt đầu từ việc quan sát mỗi phân nhóm, các phân nhóm sẽ gom lại với nhau và chuyển thành cấp cao hơn trong cây.
%Trong trường hợp thông thường, độ phức tạp của thuật toán theo hướng tiếp cận tích tụ là $O(n^2\log(n))$.
%Tuy nhiên, thuật toán có thể tối ưu hóa để làm giảm độ phức tạp bằng cách sử dụng liên kết đơn hoặc là liên kết toàn phần.
		
%Ví dụ
%		Cho dữ liệu thô sau, ta sẽ sử dụng hướng tiếp cận tích tụ để gom nhóm phân cấp với công thức tính khoảng cách là Euclid.
%		
%		\begin{tikzpicture}
%		\draw(10,20) circle (5mm) node{$c$};
%		\end{tikzpicture}

%Các phương pháp liên kết trong hướng tiếp cận tích tụ
\section{Các phương pháp liên kết}
\label{sec:cpplk}
~\cite{AHC, Vipin-Kumar} Trong thuật toán \ref{agl:agglomerative}, mấu chốt của vấn đề là cách tính độ tương đồng giữa các nhóm.
Cách tính độ tương đồng khác nhau có thể dẫn đến kết quả khác nhau của gom nhóm phân cấp tích tụ.
Độ tương đồng của các nhóm được tính bằng cách sử dụng nhiều kỹ thuật liên kết khác nhau.
Các kỹ thuật liên kết thường có trong gom nhóm phân cấp tích tụ: liên kết đơn (còn có tên gọi khác là nhỏ nhất), liên kết toàn vẹn (hay còn gọi là lớn nhất) và liên kết nhóm trung bình.
Liên kết đơn định nghĩa độ tương đồng của nhóm là độ tương đồng giữa 2 điểm gần nhất ở 2 nhóm khác nhau, nghĩa là khoảng cách gần nhất giữa hai nốt của hai tập khác nhau.
Liên kết đơn tạo ra các nhóm liền kề như trong hình \ref{fig:pic14}.
Hình \ref{fig:pic22} cho ta thấy gom nhóm phân cấp tích tụ theo kỹ thuật liên kết đơn.
\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-2.4)(12.4,2.4)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](2.0,0.4)(2.0,1.2)
\pscircle[linecolor=black, linewidth=0.04, dimen=outer](10.0,0.0){2.4}
\psdots[linecolor=black, dotsize=0.2](2.0,1.2)
\psdots[linecolor=black, dotsize=0.2](1.2,-0.4)
\psdots[linecolor=black, dotsize=0.2](8.4,0.0)
\psdots[linecolor=black, dotsize=0.2](9.6,1.6)
\psdots[linecolor=black, dotsize=0.2](11.2,-1.2)
\psdots[linecolor=black, dotsize=0.2](3.2,0.4)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](3.2,0.4)(8.4,0.0)(8.4,0.0)
\end{pspicture}
}
\caption{Liên kết đơn}
\label{fig:pic22}
\end{figure}

Trong khi đó, liên kết toàn vẹn tính độ tương đồng của nhóm dựa vào 2 điểm xa nhất ở 2 hai nhóm khác nhau, nghĩa là khoảng cách xa nhất giữa 2 nốt của 2 tập khác nhau.
Hình \ref{fig:pic23} cho ta thấy kỹ thuật liên kết hoàn toàn.
\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-2.4)(12.4,2.4)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](2.0,0.4)(2.0,1.2)
\pscircle[linecolor=black, linewidth=0.04, dimen=outer](10.0,0.0){2.4}
\psdots[linecolor=black, dotsize=0.2](2.0,1.2)
\psdots[linecolor=black, dotsize=0.2](1.2,-0.4)
\psdots[linecolor=black, dotsize=0.2](8.4,0.0)
\psdots[linecolor=black, dotsize=0.2](9.6,1.6)
\psdots[linecolor=black, dotsize=0.2](11.2,-1.2)
\psdots[linecolor=black, dotsize=0.2](3.2,0.4)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](1.2,-0.4)(1.2,-0.4)(11.2,-1.2)
\end{pspicture}
}
\caption{Liên kết toàn vẹn}
\label{fig:pic23}
\end{figure}

Một hướng tiếp cận khác là kỹ thuật gom nhóm trung bình với định nghĩa độ tương đồng là khoảng cách trung bình của tất cả các điểm trong hai nhóm.
Hình \ref{fig:pic24} cho ta thấy kỹ thuật nhóm trung bình.
\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-2.4)(12.4,2.4)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](2.0,0.4)(2.0,1.2)
\pscircle[linecolor=black, linewidth=0.04, dimen=outer](10.0,0.0){2.4}
\psdots[linecolor=black, dotsize=0.2](2.0,1.2)
\psdots[linecolor=black, dotsize=0.2](1.2,-0.4)
\psdots[linecolor=black, dotsize=0.2](8.4,0.0)
\psdots[linecolor=black, dotsize=0.2](9.6,1.6)
\psdots[linecolor=black, dotsize=0.2](11.2,-1.2)
\psdots[linecolor=black, dotsize=0.2](3.2,0.4)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](1.2,-0.4)(1.2,-0.4)(11.2,-1.2)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](1.2,-0.4)(8.4,0.0)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](1.2,-0.4)(9.6,1.6)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](2.0,1.2)(9.6,1.6)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](2.0,1.2)(8.4,0.0)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](2.0,1.2)(11.2,-1.2)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](3.2,0.4)(9.6,1.6)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](3.2,0.4)(8.4,0.0)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](3.2,0.4)(11.2,-1.2)
\end{pspicture}
}
\caption{Nhóm trung bình}
\label{fig:pic24}
\end{figure}

Ngoài ra, ta có thể gom nhóm phân cấp tích tụ dựa vào mẫu khi ta xem một nhóm được đại diện bởi điểm trung tâm thì khi đó độ tương đồng giữa 2 nhóm sẽ trở thành độ tương đồng giữa 2 điểm trung tâm.
Một cách tiếp cận khác có tên gọi là Ward cũng gần như xem một nhóm được đại diện bởi điểm trung tâm.
Tuy nhiêm, phương pháp Ward tính độ tương đồng giữa hai nhóm dựa vào điều kiện gia tăng trong SSE (error sum of squared) từ kết quả của quá trình gom nhóm.
Tương tự như K-means, phương pháp Ward cũng cố gắng giảm tổng bình phương của khoảng cách từ điểm đến điểm trung tâm của nhóm.

Sau đây là phần dữ liệu mẫu được thể hiện qua biểu đồ \ref{fig:pic25}, bảng \ref{tab:2_1} và bảng \ref{tab:2_2} với mục đích dùng để mô tả các kỹ thuật liên kết khác nhau trong gom nhóm phân cấp tích tụ.
\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-3.9618518)(8.025,3.9618518)
\psline[linecolor=black, linewidth=0.04](0.7038889,3.7418518)(0.7038889,-3.3692594)(0.7038889,-3.3692594)(7.815,-3.3692594)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](1.8890741,3.7418518)(1.8890741,-3.3692594)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](3.0742593,-3.3692594)(3.0742593,3.7418518)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](4.259444,3.7418518)(4.259444,-3.3692594)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](5.4446297,3.7418518)(5.4446297,-3.3692594)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](6.6298146,-3.3692594)(6.6298146,3.7418518)(6.6298146,3.7418518)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](7.815,3.7418518)(7.815,-3.3692594)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](0.7038889,-2.1840742)(7.815,-2.1840742)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](0.7038889,-0.9988889)(7.815,-0.9988889)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](0.7038889,0.1862963)(7.815,0.1862963)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](0.7038889,1.3714815)(7.815,1.3714815)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](0.7038889,2.5566666)(7.815,2.5566666)
\psline[linecolor=black, linewidth=0.04, linestyle=dotted, dotsep=0.10583334cm](0.7038889,3.7418518)(7.815,3.7418518)
\rput[b](0.4075926,-3.6655555){0}
\rput[b](1.8890741,-3.9618518){0.1}
\rput[b](3.0742593,-3.9618518){0.2}
\rput[b](4.259444,-3.9618518){0.3}
\rput[b](5.4446297,-3.9618518){0.4}
\rput[b](6.6298146,-3.9618518){0.5}
\rput[b](7.815,-3.9618518){0.6}
\rput[b](0.215,-2.1840742){0.1}
\rput[b](0.215,-0.9988889){0.2}
\rput[b](0.215,0.1862963){0.3}
\rput[b](0.215,1.3714815){0.4}
\rput[b](0.215,2.5566666){0.5}
\rput[b](0.215,3.7418518){0.6}
\psdots[linecolor=black, dotsize=0.2](1.5927777,1.6677778)
\psdots[linecolor=black, dotsize=0.2](3.3705556,1.0751852)
\psdots[linecolor=black, dotsize=0.2](5.4446297,2.852963)
\psdots[linecolor=black, dotsize=0.2](4.852037,0.48259258)
\psdots[linecolor=black, dotsize=0.2](6.0372224,0.1862963)
\psdots[linecolor=black, dotsize=0.2](3.6668518,-1.2951852)
\rput[b](1.8890741,1.6677778){5}
\rput[b](3.6668518,1.0751852){2}
\rput[b](5.740926,2.852963){1}
\rput[b](5.1483335,0.48259258){3}
\rput[b](6.3335185,0.1862963){6}
\rput[b](3.963148,-1.5914814){4}
\end{pspicture}
}
\caption{Đồ thị thể hiện tọa độ giữa các điểm}
\label{fig:pic25}
\end{figure}

\begin{table}[h!]
\centering
\caption{Bảng thể hiện tọa độ của các điểm}
\label{tab:2_1}
\begin{tabular}{|c|c|c|}
\hline
Điểm & x & y \\ \hline
p1    & 0.40         & 0.53         \\ \hline
p2    & 0.22         & 0.38         \\ \hline
p3    & 0.35         & 0.32         \\ \hline
p4    & 0.26         & 0.19         \\ \hline
p5    & 0.08         & 0.41         \\ \hline
p6    & 0.45         & 0.30         \\ \hline
\end{tabular}
\end{table}

\begin{table}[h!]
\centering
\caption{Bảng thể hiện độ đo khoảng cách Euclean giữa các điểm}
\label{tab:2_2}
\begin{tabular}{|c|c|c|c|c|c|c|}
\hline
   & p1   & p2   & p3   & p4   & p5   & p6   \\ \hline
p1 & 0.00 & 0.24 & 0.22 & 0.37 & 0.34 & 0.23 \\ \hline
p2 & 0.24 & 0.00 & 0.15 & 0.2  & 0.14 & 0.25 \\ \hline
p3 & 0.22 & 0.15 & 0.00 & 0.15 & 0.28 & 0.11 \\ \hline
p4 & 0.37 & 0.2  & 0.15 & 0.00 & 0.29 & 0.22 \\ \hline
p5 & 0.34 & 0.14 & 0.28 & 0.29 & 0.00 & 0.39 \\ \hline
p6 & 0.23 & 0.25 & 0.11 & 0.22 & 0.39 & 0.00 \\ \hline
\end{tabular}%
\end{table}

\subsection{Liên kết đơn}	
\label{sec:lkd}	
%Giói thiệu
~\cite{Vipin-Kumar, HAC, AHC, hierarchical-clustering, single-complete, explain-HAC} Liên kết đơn hay kỹ thuật nhỏ nhất trong gom nhóm phân cấp tích tụ là phương pháp xem độ tương đồng của hai nhóm là khoảng cách gần nhất của hai điểm bất kì trong mỗi nhóm. 
Kỹ thuật này bắt đầu với tất cả các điểm đơn lẻ được xem như là một nhóm.
Sau đó, ta sẽ lần lượt tính khoảng cách giữa các điểm, chọn khoảng cách ngắn nhất giữa hai điểm thuộc hai nhóm khác nhau rồi gom 2 nhóm này lại thành một nhóm.
Thuật toán sẽ thực thi cho đến khi chỉ còn lại một nhóm duy nhất.
Liên kết đơn là kỹ thuật mạnh trong xử lí dữ liệu có hình dạng phi ellip nhưng có nhược điểm là nhạy cảm với độ nhiễu và những điểm tách biệt.

%Chi tiết
Dựa vào hình \ref{fig:pic26}, ta thấy được kết quả của việc ứng dụng kỹ thuật liên kết đơn trong gom nhóm phân cấp tích tụ đối với dữ liệu ở \ref{fig:pic25}.
Phần bên trái của hình \ref{fig:pic26} là một chuỗi các vòng ellip lồng vào nhau.
Ở mỗi vòng ellip, một con số thứ tự xuất hiện để thể hiện các nhóm được gom ở bước tương ứng.
Phần bên phải của hình \ref{fig:pic26} có thông tin tương tự như phần bên trái nhưng được biểu diễn dưới dạng đồ thị.
Chiều cao mà hai nhóm gom lại vào nhau trong đồ thị thể hiện khoảng cách của hai nhóm.
Ví dụ, từ bảng \ref{tab:2_2}, ta có thể thấy khoảng cách giữa 2 điểm 3 và 6 là 0.11 và đây cũng là khoảng cách ngắn nhất giữa các điểm để hai nhóm sát nhập vào nhau thành một. 
Một ví dụ khác, khoảng cách giữa các nhóm \{3, 6\} và \{2, 5\} được tính  bằng cách
\begin{equation}
\begin{aligned}
dist(\{3, 6\}, \{2, 5\})
&= min(dist(3,2),dist(6, 2), dist(3, 5), dist(6, 5)) \\
&= min (0.148, 0.254, 0.284, 0.392) = 0.148. \\
\end{aligned}
\end{equation}


\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-3.6)(16.92,3.6)
\pscircle[linecolor=black, linewidth=0.04, dimen=outer](3.6,0.0){3.6}
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](3.6,0.0)(3.2,2.8)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](3.6,0.4)(2.8,2.0)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](2.6,1.0)(1.4,0.6)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](4.2,-0.6)(1.4,0.6)
\rput[bl](3.6,-3.2){4}
\rput[bl](6.8,2.4){5}
\rput[bl](2.8,2.0){2}
\rput[bl](4.4,1.6){3}
\rput[bl](4.8,0.4){1}
\psdots[linecolor=black, dotsize=0.2](3.2,3.2)
\psdots[linecolor=black, dotsize=0.2](1.6,1.2)
\psdots[linecolor=black, dotsize=0.2](2.8,0.8)
\psdots[linecolor=black, dotsize=0.2](3.2,-0.4)
\psdots[linecolor=black, dotsize=0.2](4.4,-0.8)
\psdots[linecolor=black, dotsize=0.2](3.2,-2.4)
\rput[bl](3.6,3.2){1}
\rput[bl](3.2,0.8){2}
\rput[bl](3.6,-0.4){3}
\rput[bl](4.8,-0.8){6}
\rput[bl](3.6,-2.4){4}
\rput[bl](2.0,1.2){5}
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,-3.2)(16.8,-3.2)
\psline[linecolor=black, linewidth=0.04](9.6,-2.0)(10.0,-2.0)(10.0,-2.0)
\psline[linecolor=black, linewidth=0.04](9.6,-0.8)(10.0,-0.8)
\psline[linecolor=black, linewidth=0.04](9.6,0.4)(10.0,0.4)
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(10.0,1.6)
\rput[bl](8.4,-2.0){0.05}
\rput[bl](8.4,-0.8){0.1}
\rput[bl](8.4,0.4){0.15}
\rput[bl](8.4,1.6){0.2}
\rput[bl](10.8,-3.6){3}
\rput[bl](12.0,-3.6){6}
\rput[bl](13.2,-3.6){2}
\rput[bl](14.4,-3.6){5}
\rput[bl](15.6,-3.6){4}
\rput[bl](16.8,-3.6){1}
\psline[linecolor=black, linewidth=0.02](10.8,-3.2)(10.8,-0.4)(12.0,-0.4)(12.0,-3.2)
\psline[linecolor=black, linewidth=0.02](13.2,-3.2)(13.2,0.0)(14.4,0.0)(14.4,-3.2)
\psline[linecolor=black, linewidth=0.02](11.2,-0.4)(11.2,0.4)(14.0,0.4)(14.0,0.0)
\psline[linecolor=black, linewidth=0.02](15.6,-3.2)(15.6,0.8)(12.4,0.8)(12.4,0.4)
\psline[linecolor=black, linewidth=0.02](14.0,0.8)(14.0,2.0)(16.8,2.0)(16.8,-3.2)
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,3.2)(9.6,3.2)
\end{pspicture}
}
\caption{Kết quả khi ứng dụng liên kết đơn}
\label{fig:pic26}
\end{figure}

%Nhược điểm

\subsection{Liên kết toàn vẹn}		
%Giới thiệu
~\cite{Vipin-Kumar, HAC, AHC, hierarchical-clustering, single-complete}Liên kết toàn vẹn còn được gọi là kỹ thuật lớn nhất hoặc là CLIQUE.
Liên kết toàn vẹn tính độ tương đồng của hai nhóm dựa vào khoảng cách lớn nhất (độ tương đồng nhỏ nhất) của hai điểm bất kì của hai nhóm khác nhau.
Kỹ thuật này bắt đầu với tất cả các điểm đơn lẻ được xem như là một nhóm.
Sau đó, ta sẽ lần lượt tính khoảng cách giữa các điểm thuộc các nhóm khác nhau và chọn khoảng cách xa nhất giữa các nhóm.
Trong số những khoảng cách xa nhất, ta sẽ chọn khoảng cách có giá trị nhỏ nhất và gom 2 nhóm có khoảng cách này thành một.
Thuật toán sẽ thực thi cho đến khi các nhóm liên kết hoàn toàn.
Liên kết toàn vẹn thường không nhạy cảm với độ nhiễu và điểm tách biệt, nhưng lại có thể chia cắt nhóm lớn và có xu hướng tạo thành nhóm toàn cục.

%Chi tiết
Hình \ref{fig:pic27} đây cho ta thấy được kết quả của việc áp dụng kỹ thuật liên kết toàn vẹn trong gom nhóm phân cấp tích tụ.
Một lần nữa, điểm 3 và 6 được gom vào thành một nhóm trước.
Tuy nhiên, \{3, 6\} lại được gom với \{4\} thay vì gom với \{2, 5\}.
Điều này xảy ra vì 
\begin{equation}
\begin{aligned}
dist(\{3, 6\}, \{4\})
&= max(dist(3, 4), dist(6, 4)) 		\\
&= max(0.15, 0.22) 					\\
&= 0.22.							\\
dist(\{3, 6\}, \{2, 5\})
&= max(dist(3, 2), dist(6, 2), dist(3, 5), dist(6, 5))			\\
&= max(0.15, 0.25, 0.28, 0.39)									\\
&= 0.392.										\\					
dist(\{3, 6\}, \{1\})
&= max(dist(3, 1), dist(6, 1)) =	\\ 
&= max(0.22, 0.23) = 0.23.		\\
\end{aligned}
\end{equation}

\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-3.6)(16.95,3.6)
\pscircle[linecolor=black, linewidth=0.04, dimen=outer](3.6,0.0){3.6}
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](2.6,1.0)(1.4,0.6)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](5.0,-0.6)(1.4,0.6)
\rput[bl](2.4,2.8){4}
\rput[bl](6.8,2.4){5}
\rput[bl](1.6,1.6){2}
\rput[bl](2.0,-1.2){3}
\rput[bl](4.8,-1.6){1}
\psdots[linecolor=black, dotsize=0.2](3.6,2.4)
\psdots[linecolor=black, dotsize=0.2](1.6,1.2)
\psdots[linecolor=black, dotsize=0.2](2.8,0.8)
\psdots[linecolor=black, dotsize=0.2](4.0,-0.4)
\psdots[linecolor=black, dotsize=0.2](5.6,-0.8)
\psdots[linecolor=black, dotsize=0.2](3.2,-2.4)
\rput[bl](4.0,2.4){1}
\rput[bl](3.2,0.8){2}
\rput[bl](4.4,-0.4){3}
\rput[bl](5.2,-0.8){6}
\rput[bl](3.6,-2.4){4}
\rput[bl](2.0,1.2){5}
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,-3.2)(16.8,-3.2)
\psline[linecolor=black, linewidth=0.04](9.6,-2.0)(10.0,-2.0)(10.0,-2.0)
\psline[linecolor=black, linewidth=0.04](9.6,-0.8)(10.0,-0.8)
\psline[linecolor=black, linewidth=0.04](9.6,0.4)(10.0,0.4)
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(10.0,1.6)
\rput[bl](8.4,-2.0){0.1}
\rput[bl](8.4,-0.8){0.2}
\rput[bl](8.4,0.4){0.3}
\rput[bl](8.4,1.6){0.4}
\rput[bl](10.8,-3.6){3}
\rput[bl](12.0,-3.6){6}
\rput[bl](13.2,-3.6){4}
\rput[bl](14.4,-3.6){1}
\rput[bl](15.6,-3.6){2}
\rput[bl](16.8,-3.6){5}
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,3.2)(9.6,3.2)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](2.8,1.6)(2.0,1.6)
\rput{36.308563}(0.025317831,-2.8772123){\psellipse[linecolor=black, linewidth=0.04, dimen=outer](4.4,-1.4)(2.8,1.4)}
\psline[linecolor=black, linewidth=0.04](10.8,-3.2)(10.8,-2.0)(12.0,-2.0)(12.0,-3.2)
\psline[linecolor=black, linewidth=0.04](11.2,-2.0)(11.2,-0.4)(13.2,-0.4)(13.2,-3.2)
\psline[linecolor=black, linewidth=0.04](15.6,-3.2)(15.6,-1.2)(16.8,-1.2)(16.8,-3.2)
\psline[linecolor=black, linewidth=0.04](14.4,-3.2)(14.4,0.8)(16.0,0.8)(16.0,-1.2)
\psline[linecolor=black, linewidth=0.04](12.0,-0.4)(12.0,1.6)(15.2,1.6)(15.2,0.8)
\end{pspicture}
}
\caption{Kết quả khi ứng dụng liên kết hoàn toàn}
\label{fig:pic27}
\end{figure}

\subsection{Nhóm trung bình}
\label{sec:ntb}
~\cite{Vipin-Kumar, HAC, AHC, hierarchical-clustering, average} Trong kỹ thuật nhóm trung bình của gom nhóm phân cấp tích tụ, độ tương đồng của hai nhóm được định nghĩa là độ trung bình của các cặp điểm ở 2 nhóm khác nhau.
Đây là hướng tiếp cận trung gian giữa kỹ thuật nhỏ nhất và kỹ thuật lớn nhất.
Độ tương đồng của nhóm trung bình $proximity(C_i, C_j)$ của nhóm $C_i$ và $C_j$, với độ lớn (số lượng điểm) là $m_i$ và $m_j$ được biểu diễn thành công thức:
\begin{equation}
proximity(C_i, C_j) = \sum_{\substack{x \in C_i \\ y \in C_j}} \frac{proximity(x, y)}{m_i * m_j}
\end{equation}

Hình \ref{fig:pic28} thể hiện kết quả của gom nhóm phân cấp tích tụ theo kỹ thuật nhóm trung bình.
Để thấy được cách hoạt động của nhóm trung bình, ta tính khoảng cách trung bình giữa các nhóm:
\begin{equation}
\begin{aligned}
dist(\{3, 6, 4\}, \{1\})
&= (0.221 + 0.368 + 0.234) / (3 * 1)	\\ 
&= 0.28									\\
dist(\{2, 5\}, \{1\})
&= (0.235 + 0.342) / (2 * 1)			\\
&= 0.2889								\\
dist(\{3, 6, 4\}, \{2, 5\})				
&= (0.148 + 0.284 + 0.254 + 0.392 + 0.204 + 0.2932) /  (6 * 2)	\\
&= 0.26									\\
\end{aligned}
\end{equation}

Do $dist(\{3, 6, 4\}, \{2, 5\})$ nhỏ hơn $dist(\{3, 6, 4\}, \{1\})$ và $dist(\{2, 5\}, \{1\})$, nên $\{3, 6, 4\}$ và $\{2, 5\}$ sẽ được gom lại thành một nhóm mới ở bước thứ tư.

\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-3.6)(16.92,3.6)
\pscircle[linecolor=black, linewidth=0.04, dimen=outer](3.6,0.0){3.6}
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](2.6,1.4)(1.4,0.6)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](4.6,0.2)(1.4,0.6)
\rput[bl](4.8,-2.8){4}
\rput[bl](6.8,2.4){5}
\rput[bl](2.8,2.0){2}
\rput[bl](1.6,-0.4){3}
\rput[bl](4.4,-0.8){1}
\psdots[linecolor=black, dotsize=0.2](3.6,3.2)
\psdots[linecolor=black, dotsize=0.2](1.6,1.6)
\psdots[linecolor=black, dotsize=0.2](2.8,1.2)
\psdots[linecolor=black, dotsize=0.2](3.6,0.4)
\psdots[linecolor=black, dotsize=0.2](5.2,0.0)
\psdots[linecolor=black, dotsize=0.2](2.8,-1.6)
\rput[bl](4.0,3.2){1}
\rput[bl](3.2,1.2){2}
\rput[bl](4.0,0.4){3}
\rput[bl](4.8,0.0){6}
\rput[bl](3.2,-1.6){4}
\rput[bl](2.0,1.6){5}
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,-3.2)(16.8,-3.2)
\psline[linecolor=black, linewidth=0.04](9.6,-2.0)(10.0,-2.0)(10.0,-2.0)
\psline[linecolor=black, linewidth=0.04](9.6,-0.8)(10.0,-0.8)
\psline[linecolor=black, linewidth=0.04](9.6,0.4)(10.0,0.4)
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(10.0,1.6)
\rput[bl](8.4,-2.0){0.05}
\rput[bl](8.4,-0.8){0.1}
\rput[bl](8.4,0.4){0.15}
\rput[bl](8.4,1.6){0.2}
\rput[bl](10.8,-3.6){3}
\rput[bl](12.0,-3.6){6}
\rput[bl](13.2,-3.6){4}
\rput[bl](14.4,-3.6){2}
\rput[bl](15.6,-3.6){5}
\rput[bl](16.8,-3.6){1}
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,3.2)(9.6,3.2)
\rput{36.308563}(0.42136064,-2.4850307){\psellipse[linecolor=black, linewidth=0.04, dimen=outer](4.0,-0.6)(2.8,1.4)}
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](3.6,-0.2)(3.2,3.0)
\psline[linecolor=black, linewidth=0.04](9.6,2.8)(10.0,2.8)
\rput[bl](8.4,2.8){0.25}
\psline[linecolor=black, linewidth=0.02](10.8,-3.2)(10.8,-0.8)(12.0,-0.8)(12.0,-3.2)
\psline[linecolor=black, linewidth=0.02](13.2,-3.2)(13.2,1.2)(11.6,1.2)(11.6,-0.8)
\psline[linecolor=black, linewidth=0.02](14.4,-3.2)(14.4,-0.4)(15.6,-0.4)(15.6,-3.2)
\psline[linecolor=black, linewidth=0.02](12.4,1.2)(12.4,2.8)(14.8,2.8)(14.8,-0.4)
\psline[linecolor=black, linewidth=0.02](16.8,-3.2)(16.8,3.2)(13.6,3.2)(13.6,2.8)
\end{pspicture}
}
\caption{Kết quả khi ứng dụng nhóm trung bình}
\label{fig:pic28}
\end{figure}

\subsection{Phương pháp Ward và điểm trung tâm}
~\cite{Vipin-Kumar, AHC, hierarchical-clustering} Phương pháp Ward tính độ tương đồng của 2 nhóm bằng sự gia tăng SSE trong quá trình gom 2 nhóm với nhau.
Vì vậy, phương pháp này có hàm mục tiêu giống như phương pháp gom nhóm K-means.
So với các phương pháp đã thảo luận ở trên thì phương pháp này có kỹ thuật hơi khác biệt.
Mặc dù vậy, công thức tính độ tương đồng của phương pháp Ward có chút tương đồng với phương pháp nhóm trung bình.
Điểm khác biệt của phương pháp Ward so với nhóm trung bình là khoảng cách giữa 2 điểm sẽ được bình phương lên.
Hình \ref{fig:pic29} sau đây thể hiện kết quả của việc áp dụng phương pháp Ward. Kết quả của quá trình gom nhóm hơi khác so với các kỹ thuật nhỏ nhất, lớn nhất và nhóm trung bình.

\begin{figure}[htp]
\psscalebox{1.0 1.0} % Change this value to rescale the drawing.
{
\begin{pspicture}(0,-3.6)(16.95,3.6)
\pscircle[linecolor=black, linewidth=0.04, dimen=outer](3.6,0.0){3.6}
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](1.8,1.4)(1.4,0.6)
\psellipse[linecolor=black, linewidth=0.04, dimen=outer](4.6,-0.6)(1.4,0.6)
\rput[bl](1.6,-1.6){4}
\rput[bl](0.8,2.8){5}
\rput{-12.733253}(-0.38180095,0.578176){\rput[bl](2.4,2.0){2}}
\rput[bl](3.2,-2.4){3}
\rput[bl](5.2,-1.6){1}
\psdots[linecolor=black, dotsize=0.2](4.8,2.0)
\psdots[linecolor=black, dotsize=0.2](0.8,1.6)
\psdots[linecolor=black, dotsize=0.2](2.0,1.2)
\psdots[linecolor=black, dotsize=0.2](3.6,-0.4)
\psdots[linecolor=black, dotsize=0.2](5.2,-0.8)
\psdots[linecolor=black, dotsize=0.2](4.0,-2.0)
\rput[bl](5.2,2.0){1}
\rput[bl](2.4,1.2){2}
\rput[bl](4.0,-0.4){3}
\rput[bl](4.8,-0.8){6}
\rput[bl](4.4,-2.0){4}
\rput[bl](1.2,1.6){5}
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,-3.2)(16.8,-3.2)
\psline[linecolor=black, linewidth=0.04](9.6,-2.0)(10.0,-2.0)(10.0,-2.0)
\psline[linecolor=black, linewidth=0.04](9.6,-0.8)(10.0,-0.8)
\psline[linecolor=black, linewidth=0.04](9.6,0.4)(10.0,0.4)
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(10.0,1.6)
\rput[bl](8.4,-2.0){0.05}
\rput[bl](8.4,-0.8){0.1}
\rput[bl](8.4,0.4){0.15}
\rput[bl](8.4,1.6){0.2}
\rput[bl](10.8,-3.6){3}
\rput[bl](12.0,-3.6){6}
\rput[bl](13.2,-3.6){4}
\rput[bl](14.4,-3.6){1}
\rput[bl](15.6,-3.6){2}
\rput[bl](16.8,-3.6){5}
\psline[linecolor=black, linewidth=0.04](9.6,1.6)(9.6,3.2)(9.6,3.2)
\psline[linecolor=black, linewidth=0.04](9.6,2.8)(10.0,2.8)
\rput[bl](8.4,2.8){0.25}
\rput{-2.7438383}(0.04357028,0.2192881){\psellipse[linecolor=black, linewidth=0.02, dimen=outer](4.6,-0.8)(1.4,1.6)}
\rput{-36.899612}(1.1215355,2.5617006){\psellipse[linecolor=black, linewidth=0.02, dimen=outer](4.4,-0.4)(2.0,3.2)}
\psline[linecolor=black, linewidth=0.02](10.8,-3.2)(10.8,-1.2)(12.0,-1.2)(12.0,-3.2)
\psline[linecolor=black, linewidth=0.02](11.2,-1.2)(11.2,0.4)(13.2,0.4)(13.2,-3.2)
\psline[linecolor=black, linewidth=0.02](15.6,-3.2)(15.6,-0.8)(16.8,-0.8)(16.8,-3.2)(16.8,-3.2)
\psline[linecolor=black, linewidth=0.02](14.4,-3.2)(14.4,2.0)(12.0,2.0)(12.0,0.4)(12.0,0.4)
\psline[linecolor=black, linewidth=0.02](13.2,2.0)(13.2,3.2)(16.0,3.2)(16.0,-0.8)
\end{pspicture}
}
\caption{Kết quả khi ứng dụng phương pháp Ward}
\label{fig:pic29}
\end{figure}

~\cite{Vipin-Kumar, AHC, hierarchical-clustering, centroid} Gom nhóm phân cấp tích tụ theo điểm trung tâm tính độ tương đồng của 2 nhóm bằng cách tính độ tương đồng của 2 điểm trung tâm trong mỗi nhóm.
%Kỹ thuật này dường như tương đồng với K-means, nhưng cần lưu ý rằng phương pháp Ward mới gần tương đồng với kỹ thuật này.
Ngoài ra, kỹ thuật này còn có đặc tính khác là sự khả nghịch mà những kỹ thuật khác không thể hiện được.
Đối với các kỹ thuật gom nhóm phân cấp tích tụ khác đã được thảo luận, độ tương đồng của quá trình gom nhóm càng về sau thì càng giảm.
Tuy nhiên, sự khả nghịch của phương pháp gom nhóm phân cấp tích tụ theo điểm trung tâm có thể làm đảo chiều quá trình này, nghĩa là độ tương đồng về sau có thể tăng chứ không phải giảm.
Điều này thường được xem là không tốt vì gây khó khăn cho việc phân tích cây phân cấp.

\section{Công thức Lance-William cho độ tương đồng nhóm}
~\cite{Vipin-Kumar} Các cách tính độ tương đồng của 2 nhóm mà được thảo luận ở phần trước \ref{sec:cpplk} có thể được tham số hóa như trong công thức \ref{eq:2_Lance_William} với các hệ số từ bảng \ref{tab:2_3}.
Chẳng hạn, ta có 2 nhóm $Q$ và $R$ với $R$ được tạo thành từ quá trình gom 2 nhóm khác là $A$ và $B$.
Ta sẽ sử dụng công thức \ref{eq:2_Lance_William} để tính độ tương đồng của 2 nhóm $Q$ và $R$ với $p(.,.)$ là hàm tương đồng của 2 nhóm, $m_A, \, m_B$ và $m_Q$ là số lượng phần tử tương ứng trong nhóm $A, \, B$ và $Q$.
Độ tương đồng của 2 nhóm $Q$ và $R$ là hàm tuyến tính của độ tương đồng giữa $Q$ với 2 nhóm gốc $A$ và $B$ (2 nhóm tạo nên $R$).
%Sau khi gom 2 nhóm $A$ và $B$ thành nhóm $R$, độ tương đồng của nhóm mới $R$ đối với nhóm hiện có $Q$ là hàm tuyến tính của độ tương đồng của nhóm $Q$ đối với 2 nhóm ban đầu $A$ và $B$.
Bảng \ref{tab:2_3} chỉ ra những giá trị của hệ số cho những kỹ thuật mà đã được thảo luận.

\begin{equation}
\label{eq:2_Lance_William}
p(R,Q)=\alpha_Ap(A,Q) + \alpha_Bp(B,Q) + \beta p(A,B) + \gamma |p(A, Q) - p(B, Q)|
\end{equation}

Bất kỳ kỹ thuật gom nhóm phân cấp nào cũng có thể biểu diễn dưới dạng công thức của Lance-William.
Ngoài ra, gom nhóm phân cấp tích tụ còn có thể loại bỏ dữ liệu gốc ban đầu bằng việc xây dựng ma trận tương đồng như bảng \ref{tab:2_2}.
Khi có nhóm mới xuất hiện, ma trận tương đồng sẽ được cập nhật giá trị giữa nhóm mới với các nhóm khác theo kỹ thuật đã được thảo luận ở phần \ref{sec:cpplk}.
Nhìn chung, công thức Lance-William giúp cho ta có cái nhìn tổng quát cũng như là dễ thực thi trong lập trình.

\begin{table}[h!]
\centering
\caption{Hệ số của Lance-William dành cho các cách gom nhóm phân cấp}
\label{tab:2_3}
\resizebox{\textwidth}{!}{%
\begin{tabular}{|l|r|r|r|r|}
\hline
Cách thức gom nhóm & $\alpha_A$ & $\alpha_B$ & $\beta$ & $\gamma$ \\ \hline \hline
Liên kết đơn       & 1/2 & 1/2 & 0 & -1/2 \\ \hline
Liên kết toàn vẹn  & 1/2 & 1/2 & 0 & 1/2 \\ \hline
Nhóm trung bình    & $\frac{m_A}{m_A + m_B}$ & $\frac{m_B}{m_A + m_B}$ & 0 & 0 \\ \hline
Trung điểm         & $\frac{m_A}{m_A + m_B}$ & $\frac{m_B}{m_A + m_B}$ & $\frac{-m_A m_B}{(m_A + m_B) ^ 2}$ & 0 \\ \hline
Phương pháp Ward   & $\frac{m_A + m_Q}{m_A + m_B + m_Q}$ & $\frac{m_B + m_Q}{m_A + m_B + m_Q}$ & $\frac{-m_Q}{m_A + m_B + m_Q}$ & 0 \\ \hline
\end{tabular}
}
\end{table}

%\begin{table}[h!]
%\centering
%\caption{Hệ số của Lance-William dành cho các cách gom nhóm phân cấp}
%\label{tab:2_3}
%\resizebox{\textwidth}{!}{%
%\begin{tabular}{|l|r|r|r|r|}
%\hline
%Cách thức gom nhóm & $\alpha_A$ & $\alpha_B$ & $\beta$ & $\gamma$ \\ \hline \hline
%Liên kết đơn       & 1/2 & 1/2 & 0 & -1/2 \\ \hline
%Liên kết hoàn toàn & 1/2 & 1/2 & 0 & 1/2 \\ \hline
%Nhóm trung bình    & $\frac{m_A}{m_A + m_B}$ & $\frac{m_B}{m_A + m_B}$ & 0 & 0 \\ \hline
%Trung điểm         & $\frac{m_A}{m_A + m_B}$ & $\frac{m_B}{m_A + m_B}$ & $\frac{-m_A m_B}{(m_A + m_B) ^ 2}$ & 0 \\ \hline
%Phương pháp Ward   & $\frac{m_A + m_Q}{m_A + m_B + m_Q}$ & $\frac{m_B + m_Q}{m_A + m_B + m_Q}$ & $\frac{-m_Q}{m_A + m_B + m_Q}$ & 0 \\ \hline
%\end{tabular}%
%}
%\end{table}

\section{Những vấn đề trong gom nhóm phân cấp}
\subsection{Thiếu hàm mục tiêu toàn cục}
Gom nhóm phân cấp tích tụ không thể được xem như là hàm mục tiêu tối ưu toàn cục.
Thay vào đo, gom nhóm phân cấp tích tụ sử dụng những kỹ thuật khác nhau để quyết định ở cục bộ mỗi bước thì nhóm nào sẽ được gom vào (hoặc là tách nếu sử dụng hướng tiếp cận phân chia).
Cách tiếp cận này tạo ra thuật toán gom nhóm tránh được khó khăn khi giải quyết vấn đề tối ưu kết hợp trong trường hợp khó.
Ngoài ra, gom nhóm phân cấp tích tụ không gặp phải vấn đề chọn điểm khởi tạo.

\subsection{Khả năng xử lý kích cỡ nhóm khác nhau}
Một khía cạnh khác của gom nhóm phân cấp tích tụ là ta vẫn chưa thảo luận làm sao để xử lý kích cỡ của cặp nhóm vừa mới được gom vào nhau (Vấn đề này chỉ áp dụng khi sử dụng độ tương đồng nhóm liên quan đến tổng như trung điểm, phương pháp Ward và nhóm trung bình).
Đối với vấn đề này, có 2 hướng tiếp cận: có trọng số, khi xem tất cả các nhóm là như nhau hoặc là không có trọng số, xem xét số lượng điểm trong mỗi nhóm.
Lưu ý rằng có trọng số hay không có trọng số liên quan đến số lượng điểm trong dữ liệu, chứ không phải nhóm.
Nghĩa là nếu ta xem xét dựa vào nhóm mà không có cùng kích thước như nhau thì dẫn đến sự khác biệt về trọng số của điểm trong các nhóm khác nhau.
Còn khi ta xem xét dựa vào kích thước của nhóm thì ta quan tâm đến số lượng điểm trong mỗi nhóm khác nhau mà các điểm này thì cùng trọng số.

Sau đây, ta sử dụng kỹ thuật gom nhóm trung bình \ref{sec:ntb} với phiên bản sử dụng không có trọng số.
Ta sẽ chuyển kỹ thuật này thành tham số của công thức như bảng \ref{tab:2_3}.
Hệ số trong trường hợp này liên quan đến kích thước của mỗi nhóm sau khi được gom xong:
\begin{equation}
\begin{aligned}
\alpha_A &= \frac{m_A}{m_A + m_B}	\\
\alpha_B &= \frac{m_B}{m_A + m_B}	\\
\beta &= 0		\\
\gamma &= 0
\end{aligned}
\end{equation}
Trong trường hợp ta sử dụng gom nhóm trung bình có trọng số thì hệ số sẽ là:
\begin{equation}
\begin{aligned}
\alpha_A &= \frac{1}{2} \\
\alpha_B &= \frac{1}{2} \\
\beta &= 0		\\
\gamma &= 0		\\
\end{aligned}
\end{equation}

Trong trường hợp tổng quát, cách tiếp cận không có trọng số được sử dụng nhiều trừ khi có lý do để tin tưởng rằng mỗi một điểm nên có trọng số riêng.

\subsection{Quyết định gom nhóm là cuối cùng}
Gom nhóm phân cấp tích tụ có xu hường chọn quyết định cục bộ tốt về kết hợp giữa 2 nhóm khi mà cùng sử dụng thông tin về độ tương đồng của nhau.
Tuy nhiên, một khi quyết định gom 2 nhóm lại với nhau được thực hiện thì không có cách nào có thể làm ngược lại được.
Cách tiếp cận này ngăn chặn tiêu chuẩn tối ưu cục bộ từ trở thành tiêu chuẩn tối ưu toàn cục.
Ví dụ, mặc dù tối tiểu hóa lỗi bình phương là tiêu chuẩn từ K-means được sử dụng trong quyết định gom nhóm của phương pháp Ward, các nhóm tại mỗi mức thì lại không thể hiện cục bộ tối tiểu theo tổng SSE.
Thay vào đó, các nhóm sẽ không ổn định, trong trường hợp là có thể có điểm ở gần trung điểm của nhóm khác hơn là trung điểm đang trong nhóm.
Dù thế nào đi nữa, phương pháp Ward thường được sử dụng như là cách thức mạnh của việc khởi tạo nhóm trọng K-means, chỉ ra rằng tối tiểu hóa lỗi bình phương cục bộ của hàm mục tiêu có liên kết với tối tiểu hóa lỗi bình phương toàn cục của hàm mục tiêu.

Một vài kỹ thuật được đề xuất đề cố gắng vượt quá giới hạn của quyết định gom nhóm là cuối cùng.
Một hường tiếp cận để giải quyết vấn đề này là di chuyển những nhánh cây ra xung quanh để cái thiện hàm mục tiêu toàn cục.
Hướng tiếp cận khác là sử dụng kỹ thuật gom nhóm phân chia như K-means để tạo ra nhiều nhóm nhỏ, rồi sử dụng gom nhóm phân cấp với những nhóm nhỏ này như là điểm khởi đầu.


%\subsection{Các cách để thực hiện vết cắt trên HAC}
%Giải thích

%Cách để thực hiện vết cắt của gom nhóm phân cấp
%Sau đây, một vài cách để cắt tạo thành các nhóm thường được sử dụng trong HAC

%Các công thức tính khoảng cách
%Trong gom nhóm văn bản, các công thức tính khoảng cách được sử dụng để đo lường giữa hai văn bản. Sau đây, một số công thức tính khoảng cách thường được sử dụng:
%\begin{enumerate}
%\item[•]Khoảng cách Euclidean : $\parallel a \,- \, b \parallel_2 \, = \, \sqrt{\underset{i}{\sum}(a_i \, - \, b_i)^2} $
%\item[•]Khoảng cách Euclidean vuông : $\parallel \, a \, - \, b \, \parallel^2_2 \, = \, \underset{i}{\sum} (a_i - b_i)^2$
%\item[•]Khoảng cách Manhatthan : $\parallel \, a \, - \, b \, \parallel_1 \, = \, \underset{i}{\sum} \mid a_i \, - \, b_i\mid$
%\item[•]Khoảng cách cực đại : $\parallel \, a \, - \, b\, \parallel_\infty \, = \, \underset{i}{max} \mid a_i \, - \, b_i \mid$
%\item[•]Khoảng cách Mahalanobis : $\sqrt{(a \, - \, b)^{\top} \, S^{-1} \, (a \, - \, b)}$ với $S$ là ma trận covariance
%\end{enumerate}


%Các phương pháp liên kết là tiêu chuẩn dùng đề tác động khoảng cách được sử dụng giữa các tập đặc trưng.
%Thuật toán sẽ hợp các cặp phân nhóm với nhau với việc tối thiểu hóa các tiêu chuẩn này.
%Gom nhóm phân cấp có 3 phương pháp liên kết: liên kết đơn, liên kết hoàn toàn và liên kết trung bình.
%\begin{enumerate}
%\item[•]Liên kết đơn tối thiểu hóa độ biến thiên giữa các phân nhóm được ghép vào nhau.
%\item[•]Liên kết hoàn toàn tối thiểu hóa khoảng cách tối đa giữa các đặc trưng của hai tập.
%\item[•]Liên kết trung bình tối thiểu hóa cách trung bình của mỗi đặc trưng của hai tập.
%\end{enumerate}
 
%Đồng gom nhóm phân cấp
%\section{Đồng gom nhóm phân cấp}
%
%	%Giới hạn của gom nhóm
%	\subsection{Giới hạn của gom nhóm}
%	
%	%Giới thiệu đồng gom nhóm
%	\subsection{Giới thiệu đồng gom nhóm}
%	Đồng gom nhóm là phương pháp gom nhóm cả hai chiều của dữ liệu(bao gồm gom nhóm văn bản và gom nhóm đặc trưng).
%	Đây là phương pháp hiệu quả vì khai thác được độ tương đồng của các phân nhóm trong chiều này của dữ liệu để gom nhóm trong chiều khác.
%	Điều này có nghĩa các phân nhóm của văn bản được đánh giá bằng các phân nhóm của đặc trưng và ngược lại.
%	Bằng cách này, các phân nhóm của văn bản có thể được tiến hành dựa trên các phân nhóm đặc trưng để giúp làm giảm số chiều của dữ liệu.
%	Như vậy, đồng gom nhóm là phương pháp hữu hiệu để giúp ta gom nhóm văn bản đồng thời làm giảm số chiều của dữ liệu.
%	%Ví sao chọn đồng gom nhóm
%	%Lợi ích của đồng gom nhóm
%	%Sự kết hợp của đồng gom nhóm với gom nhóm phân cấp
%	%Công dụng của đồng gom nhóm phân cấp
%	%Lợi ích của đồng gom nhóm phân cấp
%	%Giải thích việc tương tác hai chiều dữ liệu
%	%Kết luận về đồng gom nhóm phân cấp
%
%%%14
%
%%Độ tương đồng Goodman kruskal
%\section{Độ tương đồng Goodman kruskal}
%
%	\subsection{Contingency table}
%	%Giới thiệu về contingency table
%	%Ví dụ về contingency table
%	
%	\subsection{Độ tương đồng Goodman Kruskal}
%	%Giới thiệu về độ tương đồng Goodman Kruskal
%	%Vì sao chọn độ tương đồng Goodman Kruskal
%	%Sử dụng Goodman kruskal trong đồng gom nhóm phân cấp
%	%Luật sử dụng cho độ tương đồng Goodman kruskal
%		%Giới thiệu
%		%Luật thứ nhất
%		%Luật thứ hai
%	%Ví dụ về cách tính Goodman kruskal
%	%Cách để gom nhóm những hàng với nhau
%	%Cách để gom nhóm những cột với nhau
%%%11
%
%%Thuật toán đồng gom nhóm phân cấp
%\section{Thuật toán đồng gom nhóm phân cấp}
%	%Các ý cần giải thích
%	\subsection{Các ý cần giải thích}
%		%Dòng, cột, ma trận trong thuật toán(2 đoạn)
%		%Mục tiêu của đồng gom nhóm phân cấp
%		%Điều kiện của các nhóm trong hàng, cột
%		%Cách để gom lại các nhóm trong ma trận
%		%Cách để tạo ra phân nhóm đầu tiên(2 đoạn)
%	%%7
%	
%	\subsection{Áp dụng Goodman kruskal trong đồng gom nhóm phân cấp}
%	%Sử dụng Goodman kruskal trong đồng gom nhóm phân cấp
%	
%		%Giới thiệu
%		\subsubsection{Giới thiệu}		
%		
%		%Công thức
%		\subsubsection{Công thức}
%		
%		%Ý tưởng
%		\subsubsection{Ý tưởng}
%			%Định nghĩa một
%			%Định nghĩa hai
%		%Giải thích
%		%Cách áp dụng để tính nhóm thích hợp
%		%Giải thích cách tính	
%		%Sự tối ưu hóa của cách tính
%		%Sự lựa chọn nhóm được gom
%		%kết quả cuối cùng khi áp dụng
%		%kết luận
%	%%11
%	%Thuật toán
%	\subsection{Thuật toán}
%		%Giải thuật 1
%		%Giải thuật 2
%		%Giải thuật 3
%		%Giải thuật 4
%		%Giải thích toàn bộ giải thuật của thuật toán(15 đoạn)
%	%%19
%	
%	%Những lưu ý về đồng gom nhóm phân cấp
%	\subsection{Những lưu ý về đồng gom nhóm phân cấp}
%		%Các tác động đến đồng góm nhóm phân cấp
%		%Sự ảnh hưởng của từng tác động này(6 đoạn)
%	%%7
%%%44
%		
%%Đồng gom nhóm phân cấp theo hướng tăng trưởng
%\section{Đồng gom nhóm phân cấp theo hướng tăng trưởng}
%	%Điểm hạn chế hiện thời của đồng gom nhóm phân cấp
%	%Phân tích tình huống của thuật toán hiện thời
%	%Phát triển thuật toán cho dữ liệu tăng trưởng theo thời gian thực
%	%hướng cần phải giải quyết
%	%Các giải thuật
%		%Giải thuật 5
%		%Giải thuật 6
%	%Giải thích các giải thuật theo hướng tổng quát(15 đoạn)
%%%21
%%%90	
%
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%%\section{Các phương pháp gom nhóm}
%%%kể ra một vài phương pháp gom nhóm: kmeans, DBScan
%%
%%\section{Phương pháp gom nhóm phân cấp}
%%\subsection{Các hướng tiếp cận}
%%\subsubsection{Hướng tiếp cận agglomerative}
%%%Giới thiệu hướng tiếp cận agglomerative
%%
%%%Ví dụ về agglomerative
%%
%%\subsubsection{Hướng tiếp cận divisive}
%%%Giới thiệu hướng tiếp cận divisive
%%
%%%Ví dụ về divisive
%%
%%\section{Đồng gom nhóm phân cấp}
%%\subsection{Giới thiệu}
%%%Điểm hạn chế về gom nhóm
%%
%%%Giới thiệu về đồng gom nhóm
%%
%%%Sự kết hợp của đồng gom nhóm phân cấp
%%
%%%Công dụng của đồng gom nhóm phân cấp
%%
%%%Giải thích việc tương tác hai chiều của dữ liệu
%%
%%%Kết luận về đồng gom nhóm phân cấp
%%
%%\subsection{Độ tương đồng Goodman Kruskal $\tau$}
%%%Vì sao chọn Goodman Kruskal $\tau$
%%
%%%Giới thiệu Goodman Kruskal $\tau$
%%
%%%Luật sử dụng Goodman Kruskal $\tau$
%%
%%%Ví dụ về Goodman Kruskal
%%
%%\subsection{Thuật toán}
%%%Giới thiệu thuật toán
%%
%%%Các giải thuật
%%
