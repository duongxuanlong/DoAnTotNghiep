\chapter{Các công trình liên quan}
\label{Chapter2}

\section{Gom nhóm phân cấp}
\subsection{Giới thiệu}
%Giới thiệu phương pháp gom nhóm phân cấp
Gom nhóm phân cấp là phương pháp gom nhóm dùng để xây dựng các nhóm thành các cấp bậc khác nhau.
Các phương pháp gom nhóm được liệt kê ở chương 1 cho ta thấy được sự hiệu quả trong việc gom nhóm và tương đối đơn giản.
Tuy nhiên, các phương pháp này chỉ cho ta thấy được kết quả gom nhóm cuối cùng, không cho chúng ta thấy được cấu trúc của dữ liệu.
Hơn thế nữa, các phương pháp này đa phần cần phải xác định số lượng phân nhóm ban đầu.
Vì vậy, một phương pháp khác được giới thiệu là gom nhóm phân cấp để khắc phục các nhược điểm trên.

\section{Các hướng tiếp cận}
%Các hướng tiếp cận
Để xây dựng nên cấu trúc cây của các phân nhóm trong gom nhóm phân cấp, ta có hai hướng tiếp cận khác nhau. Đó là hướng tiếp cận tích tụ và hướng tiếp cận phân chia.

\subsection{Hướng tiếp cận phân chia}
%Hướng tiếp cận divisive	
%Giới thiệu
Hướng tiếp cận phân chia là một trong những cách tiếp cận của gom nhóm phân cấp.
Tuy nhiên, hướng tiếp cận này ít phổ biến hơn so với hướng tiếp cận tích tụ.
Đây là phương pháp tiếp cận gom nhóm theo cách đi từ trên xuống.
Kỹ thuật này còn có tên gọi khác là tối tiểu hóa khoảng cách của độ tương đồng đồ thị.

Kỹ thuật tối tiểu hóa khoảng cách cây của độ tương đồng đồ thị được xây dựng bắt đầu bằng một điểm bất kỳ nào của cây.
Trong những bước tiếp theo, ta sẽ tìm kiếm những cặp điểm gần nhất, $p$ và $q$ sao cho với điểm $p$ là điểm hiện đang thuộc thuộc về cây còn điểm $q$ thì không.
Ta sẽ thêm $p$ vào cây và nối cạnh giữa hai điểm $p$ và $p$.
Sau đây là thuật toán thể hiện ý tưởng trên:

\begin{algorithm}
\caption{Divisive Hierarchical Clustering Algorithm}\label{Divisive}
\begin{algorithmic}[1]
\State Compute a minimum spanning tree for the proximity graph.
\Repeat
\State Create a new cluster by breaking the link corresponding to the largest distance (smallest similarity).
\Until{Only singleton clusters remains.}
\end{algorithmic}
\end{algorithm}

%Phương pháp này bắt đầu từ việc quan sát tất cả chỉ trong một phân nhóm, và khi di chuyển xuống sẽ tách dần dần thành các phân nhóm con.
%Quá trình gộp và tách thường sẽ tốn nhiều chi phí cho thuật toán.
%Khác với hướng tiếp cận tích tụ, hướng tiếp cận phân chia có độ phức tạp lớn hơn, $O(2^n)$.
		
%Ví dụ
		
\subsection{Hướng tiếp cận tích tụ}
%Hướng tiếp cận agglomerative
\subsubsection{Giới thiệu}
%Giới thiệu
Nhiều kỹ thuật gom nhóm phân cấp khác nhau đều hướng đến một mục tiêu: bắt đầu bằng việc xem mỗi điểm như là một nhóm, sau đó dần dần gom các nhóm đơn lẻ này lại với nhau thành nhóm lớn hơn và cho đến khi chỉ còn lại một nhóm duy nhất.
Sau đây là thuật toán mô tả quá trình gom nhóm theo hướng tích tụ.

\begin{algorithm}
\caption{Basic Agglomerative Hierarchical Clustering Algorithm}\label{agglomerative}
\begin{algorithmic}[1]
\State Compute the proximity graph, if neccessary.
\Repeat
\State Merge the closest two clusters.
\State Update the proximity matrix to reflect the proximity between the new cluster and the original clusters.
\Until{Only one cluster remains.}
\end{algorithmic}
\end{algorithm}

%Hướng tiếp cận tích tụ là một trong những cách tiếp cận của gom nhóm phân cấp.
%Đây là phương pháp tiếp cận gom nhóm theo cách đi từ dưới lên.
%Phương pháp này bắt đầu từ việc quan sát mỗi phân nhóm, các phân nhóm sẽ gom lại với nhau và chuyển thành cấp cao hơn trong cây.
%Trong trường hợp thông thường, độ phức tạp của thuật toán theo hướng tiếp cận tích tụ là $O(n^2\log(n))$.
%Tuy nhiên, thuật toán có thể tối ưu hóa để làm giảm độ phức tạp bằng cách sử dụng liên kết đơn hoặc là liên kết toàn phần.
		
%Ví dụ
%		Cho dữ liệu thô sau, ta sẽ sử dụng hướng tiếp cận tích tụ để gom nhóm phân cấp với công thức tính khoảng cách là Euclid.
%		
%		\begin{tikzpicture}
%		\draw(10,20) circle (5mm) node{$c$};
%		\end{tikzpicture}

%Các phương pháp liên kết trong hướng tiếp cận tích tụ
\subsubsection{Các phương pháp liên kết}
Điểm khác biệt trong gom nhóm phân cấp theo hướng tích tụ so với hướng phân chia chính là cách tính độ tương đồng giữa các nhóm và điều đó làm cho kết quả của thuật toán trở nên khác biệt tùy vào độ tương đồng.
Độ tương đồng của các nhóm thường được định nghĩa tùy vào quan điểm ngữ cảnh của các nhóm.
Chẳng hạn khi ta xem một nhóm như là đại diện của tất các điểm trong đó, nếu ta xem độ tương đồng giữa 2 điểm thuộc hai nhóm khác nhau có khoảng cách gần nhất là độ tương đồng của hai nhóm thì ta có kỹ thuật \textit{nhỏ nhất} và thường được gọi là liên kết đơn.
Tương tự, ta có thể xem xét độ tương đồng với hai điểm xa nhất giữa hai nhóm khác nhau để tạo thành độ tương đồng giữa hai nhóm, đây được xem là kỹ thuật \textit{xa nhất} và được gọi là liên kết toàn vẹn.
Ngoài ra, ta còn có thể tính độ tương đồng giữa các cặp nhóm thông qua khoảng cách trung bình của các điểm để tạo thành kỹ thuật \textit{nhóm trung bình}.

Ở những cách trên, ta xem một nhóm như là đại diện cho tất cả những điểm trong đó.
Tuy nhiên, ta có thể thay đổi hướng tiếp cận bằng cách sử dụng một điểm như là một đại diện cho toàn nhóm và điểm này chính là điểm trung tâm của nhóm.
Với hướng tiếp cận này, độ tương đồng của hai nhóm được xem như là độ tương đồng của hai điểm trung tâm.
Ngoài ra, một cách khác có hướng tiếp cận tương đối khác biệt là phương pháp Ward.
Phương pháp Ward tính độ tương đồng giữa hai nhóm dựa vào kết quả tối tiểu hóa khoảng cách sum of squard giữa các điểm của hai nhóm.

%Độ phức tạp của thuật toán
Kỹ thuật thường được sử dụng trong gom nhóm phân cấp là ma trận tương đồng.
Điều này đòi hỏi tính toán và lưu trữ gần $m^2$ với $m$ là số điểm của dữ liệu.
Qua đó, ta có thể thấy được sự hạn chế của số lượng dữ liệu có thể tiến hành thực nghiệm.
Ngoài ra, thời gian để chạy thuật toán thường của gom nhóm phân cấp theo hướng tiếp cận tích tụ thường là $O(m^2 \log{m}).$

\subsubsection{Liên kết đơn}		
%Giói thiệu
Liên kết đơn hay kỹ thuật nhỏ nhất trong gom nhóm phân cấp là phương pháp xem xét độ tương đồng của hai nhóm chính là khoảng cách gần nhất của hai điểm bất kì trong mỗi nhóm. 
Phương pháp này được gọi là liên kết đơn vì thuật toán bắt đầu với tất cả các điểm đơn lẻ được xem như là một nhóm, thêm kết nối giữa các nhóm này với liên kết ``mạnh'' trước rồi những liên kết này kết nối các điểm lại với nhau.
Liên kết đơn là kỹ thuật mạnh trong xử lí dữ liệu có hình dạng không phải ellip và đồng thời cũng nhạy cảm với độ nhiễu và những điểm tách biệt.

%Chi tiết
Hình vẽ sau đây thể hiện kỹ thuật liên kết đơn trong gom nhóm phân cấp.
Ta có thể thấy hình bên trái là một chuỗi các vòng ellip lồng vào nhau, còn hình bên phải là biểu đồ đồ thị thể hiện thông tin lúc gom nhóm.
Chiều cao mà hai nhóm gom lại vào nhau trong đồ thị thể hiện khoảng cách của hai nhóm.
Ví dụ, từ biểu đồ, ta có thể thấy khoảng cách giữa 2 điểm 3 và 6 là 0.11 và đây cũng là khoảng cách dài nhất mà hai nhóm sát nhập vào nhau thành một. 
Một ví dụ khác, khoảng cách giữa các nhóm \{3, 6\} và \{2, 5\} được tính  bằng cách $dist(\{3, 6\}, \{2, 5\}) = min(dist(3,2),dist(6, 2), dist(3, 5), dist(6, 5)) = min (0.148, 0.254, 0.284, 0.392) = 0.148$.

%Nhược điểm

\subsubsection{Liên kết toàn vẹn}		
%Giới thiệu
Liên kết toàn vẹn còn được gọi là kỹ thuật lớn nhất hoặc là CLIQUE.
Liên kết toàn vẹn tính độ tương đồng của hai nhóm dựa vào khoảng cách lớn nhất của hai điểm bất kì của hai nhóm khác nhau.
Kỹ thuật này gọi là liên kết toàn vẹn vì khi ta bắt đầu tất cả các điểm được xem như là các nhóm đơn lẻ và thêm đường kết nối giữa các điểm, đường liên kết ``mạnh'' trước, sau đó nhóm các điểm không phải cùng trong nhóm cho đến khi tất cả các điểm được liên kết hoàn toàn.
Liên kết toàn vẹn thường không nhạy cảm với độ nhiễu và điểm tách biệt, nhưng lại có thể chia cắt nhóm lớn và có xu hướng tạo thành nhóm toàn cục.

%Chi tiết
Hình vẽ sau đây cho ta thấy được kết quả của việc áp dụng kỹ thuật liên kết toàn vẹn trong gom nhóm phân cấp.
Một lần nữa, điểm 3 và 6 được gom vào thành một nhóm trước.
Tuy nhiên, \{3, 6\} lại được gom với \{4\} thay vì gom với \{2, 5\}.
Điều này xảy ra vì $dist(\{3, 6\}, \{4\}) = max(dist(3, 4), dist(6, 4)) = max(0.151, 0.221) = 0.221$, đây là khoảng cách nhỏ hơn $dist(\{3, 6\}, \{2, 5\}) = max(dist(3, 2), dist(6, 2), dist(3, 5), dist(6, 5)) = max(0.148, 0.254, 0.284, 0.392) = 0.392$ và $dist({3, 6}, {1}) = max(dist(3, 1), dist(6, 1)) = max(0.221, 0.234) = 0.234$.

%Nhược điểm

\subsubsection{Nhóm trung bình}
Trong kỹ thuật nhóm trung bình của gom nhóm phân cấp, độ tương đồng của hai nhóm được định nghĩa là độ tương đồng trung bình của cặp nhóm với tất cả các điểm trong các nhóm khác nhau.
Đây là hướng tiếp cận trung gian giữa kỹ thuật nhỏ nhất và kỹ thuật lớn nhất với công thức: 
\begin{equation}
proximity(cluster_1, cluster_2) = \sum_{\substack{p_1 \in cluster_1 \\ p_2 \in cluster_2}} \frac{proximity(p_1, p_2)}{size(cluster_1) * size(cluster_2)}
\end{equation}

Hình vẽ sau đây thể hiện kết quả của gom nhóm phân cấp theo kỹ thuật nhóm trung bình.
Để thấy được cách hoạt động của nhóm trung bình, ta tính khoảng cách giữa các nhóm:
\begin{enumerate}
\item[]$dist(\{3, 6, 4\}, \{1\}) = (0.221 + 0.368 + 0.234) / (3 * 1) = 0.275$. 
\item[]$dist(\{2, 5\}, \{1\}) = (0.235 + 0.342) / (2 * 1)$.
\item[]$dist(\{3, 6, 4\}, \{2, 5\}) = (0.148 + 0.284 + 0.254 + 0.392 + 0.204 + 0.2932) /  (3 * 2) = 0.263$.
\end{enumerate}

Do $dist(\{3, 6, 4\}, \{2, 5\})$ nhỏ hơn $dist(\{3, 6, 4\}, \{1\})$ và $dist(\{2, 5\}, \{1\})$, nên $dist(\{3, 6, 4\}, \{1\})$ và $dist(\{2, 5\}, \{1\})$ sẽ được gom lại thành một nhóm mới ở bước thứ tư.

\subsubsection{Kỹ thuật điểm trung tâm và phương pháp Ward}
Cách tính độ tương đồng của phương pháp Ward giữa hai nhóm là tối tiểu hóa độ lỗi của kết quả trong lúc gom nhóm.
Vì vậy, phương pháp này có hàm mục tiêu giống như phương pháp gom nhóm K-means.
Phương pháp này dường như là kỹ thuật hơi tách biệt so với những phương pháp khác, một vài công thức đại số chỉ ra rằng kỹ thuật này hơi giống với phương pháp nhóm trung bình khi mà độ tương đồng giữa hai điểm là khoảng cách được bình phương giữa chúng.
Hình vẽ sau đây thể hiện kết quả của việc áp dụng phương pháp Ward. Kết quả của quá trình gom nhóm hơi khác so với các kỹ thuật nhỏ nhất, lớn nhất và nhóm trung bình.

Kỹ thuật điểm trung tâm tính độ tương đồng giữa hai nhóm bằng việc tính khoảng cách giữa hai điểm trung tâm của hai nhóm.
Kỹ thuật này dường như tương đồng với K-means, nhưng cần lưu ý rằng phương pháp Ward mới gần tương đồng với kỹ thuật này.

Ngoài ra, kỹ thuật điểm trung tâm còn có đặc tính khác là sự khả nghịch mà những kỹ thuật khác không thể hiện được.
Đối với gom nhóm phân cấp, quá trình gom hai nhóm về sau thì độ tương đồng giảm so với hai nhóm được gom trước đó.
Tuy nhiên, sự khả nghịch có thể làm đảo chiều quá trình này, nghĩa là độ tương đồng về sau có thể tăng chứ không phải giảm.


\subsubsection{Các cách để thực hiện vết cắt trên HAC}
%Giải thích

%Cách để thực hiện vết cắt của gom nhóm phân cấp
Sau đây, một vài cách để cắt tạo thành các nhóm thường được sử dụng trong HAC

%Các công thức tính khoảng cách
%Trong gom nhóm văn bản, các công thức tính khoảng cách được sử dụng để đo lường giữa hai văn bản. Sau đây, một số công thức tính khoảng cách thường được sử dụng:
%\begin{enumerate}
%\item[•]Khoảng cách Euclidean : $\parallel a \,- \, b \parallel_2 \, = \, \sqrt{\underset{i}{\sum}(a_i \, - \, b_i)^2} $
%\item[•]Khoảng cách Euclidean vuông : $\parallel \, a \, - \, b \, \parallel^2_2 \, = \, \underset{i}{\sum} (a_i - b_i)^2$
%\item[•]Khoảng cách Manhatthan : $\parallel \, a \, - \, b \, \parallel_1 \, = \, \underset{i}{\sum} \mid a_i \, - \, b_i\mid$
%\item[•]Khoảng cách cực đại : $\parallel \, a \, - \, b\, \parallel_\infty \, = \, \underset{i}{max} \mid a_i \, - \, b_i \mid$
%\item[•]Khoảng cách Mahalanobis : $\sqrt{(a \, - \, b)^{\top} \, S^{-1} \, (a \, - \, b)}$ với $S$ là ma trận covariance
%\end{enumerate}


%Các phương pháp liên kết là tiêu chuẩn dùng đề tác động khoảng cách được sử dụng giữa các tập đặc trưng.
%Thuật toán sẽ hợp các cặp phân nhóm với nhau với việc tối thiểu hóa các tiêu chuẩn này.
%Gom nhóm phân cấp có 3 phương pháp liên kết: liên kết đơn, liên kết hoàn toàn và liên kết trung bình.
%\begin{enumerate}
%\item[•]Liên kết đơn tối thiểu hóa độ biến thiên giữa các phân nhóm được ghép vào nhau.
%\item[•]Liên kết hoàn toàn tối thiểu hóa khoảng cách tối đa giữa các đặc trưng của hai tập.
%\item[•]Liên kết trung bình tối thiểu hóa cách trung bình của mỗi đặc trưng của hai tập.
%\end{enumerate}
 
%Đồng gom nhóm phân cấp
\section{Đồng gom nhóm phân cấp}

	%Giới hạn của gom nhóm
	\subsection{Giới hạn của gom nhóm}
	
	%Giới thiệu đồng gom nhóm
	\subsection{Giới thiệu đồng gom nhóm}
	Đồng gom nhóm là phương pháp gom nhóm cả hai chiều của dữ liệu(bao gồm gom nhóm văn bản và gom nhóm đặc trưng).
	Đây là phương pháp hiệu quả vì khai thác được độ tương đồng của các phân nhóm trong chiều này của dữ liệu để gom nhóm trong chiều khác.
	Điều này có nghĩa các phân nhóm của văn bản được đánh giá bằng các phân nhóm của đặc trưng và ngược lại.
	Bằng cách này, các phân nhóm của văn bản có thể được tiến hành dựa trên các phân nhóm đặc trưng để giúp làm giảm số chiều của dữ liệu.
	Như vậy, đồng gom nhóm là phương pháp hữu hiệu để giúp ta gom nhóm văn bản đồng thời làm giảm số chiều của dữ liệu.
	%Ví sao chọn đồng gom nhóm
	%Lợi ích của đồng gom nhóm
	%Sự kết hợp của đồng gom nhóm với gom nhóm phân cấp
	%Công dụng của đồng gom nhóm phân cấp
	%Lợi ích của đồng gom nhóm phân cấp
	%Giải thích việc tương tác hai chiều dữ liệu
	%Kết luận về đồng gom nhóm phân cấp

%%14

%Độ tương đồng Goodman kruskal
\section{Độ tương đồng Goodman kruskal}

	\subsection{Contingency table}
	%Giới thiệu về contingency table
	%Ví dụ về contingency table
	
	\subsection{Độ tương đồng Goodman Kruskal}
	%Giới thiệu về độ tương đồng Goodman Kruskal
	%Vì sao chọn độ tương đồng Goodman Kruskal
	%Sử dụng Goodman kruskal trong đồng gom nhóm phân cấp
	%Luật sử dụng cho độ tương đồng Goodman kruskal
		%Giới thiệu
		%Luật thứ nhất
		%Luật thứ hai
	%Ví dụ về cách tính Goodman kruskal
	%Cách để gom nhóm những hàng với nhau
	%Cách để gom nhóm những cột với nhau
%%11

%Thuật toán đồng gom nhóm phân cấp
\section{Thuật toán đồng gom nhóm phân cấp}
	%Các ý cần giải thích
	\subsection{Các ý cần giải thích}
		%Dòng, cột, ma trận trong thuật toán(2 đoạn)
		%Mục tiêu của đồng gom nhóm phân cấp
		%Điều kiện của các nhóm trong hàng, cột
		%Cách để gom lại các nhóm trong ma trận
		%Cách để tạo ra phân nhóm đầu tiên(2 đoạn)
	%%7
	
	\subsection{Áp dụng Goodman kruskal trong đồng gom nhóm phân cấp}
	%Sử dụng Goodman kruskal trong đồng gom nhóm phân cấp
	
		%Giới thiệu
		\subsubsection{Giới thiệu}		
		
		%Công thức
		\subsubsection{Công thức}
		
		%Ý tưởng
		\subsubsection{Ý tưởng}
			%Định nghĩa một
			%Định nghĩa hai
		%Giải thích
		%Cách áp dụng để tính nhóm thích hợp
		%Giải thích cách tính	
		%Sự tối ưu hóa của cách tính
		%Sự lựa chọn nhóm được gom
		%kết quả cuối cùng khi áp dụng
		%kết luận
	%%11
	%Thuật toán
	\subsection{Thuật toán}
		%Giải thuật 1
		%Giải thuật 2
		%Giải thuật 3
		%Giải thuật 4
		%Giải thích toàn bộ giải thuật của thuật toán(15 đoạn)
	%%19
	
	%Những lưu ý về đồng gom nhóm phân cấp
	\subsection{Những lưu ý về đồng gom nhóm phân cấp}
		%Các tác động đến đồng góm nhóm phân cấp
		%Sự ảnh hưởng của từng tác động này(6 đoạn)
	%%7
%%44
		
%Đồng gom nhóm phân cấp theo hướng tăng trưởng
\section{Đồng gom nhóm phân cấp theo hướng tăng trưởng}
	%Điểm hạn chế hiện thời của đồng gom nhóm phân cấp
	%Phân tích tình huống của thuật toán hiện thời
	%Phát triển thuật toán cho dữ liệu tăng trưởng theo thời gian thực
	%hướng cần phải giải quyết
	%Các giải thuật
		%Giải thuật 5
		%Giải thuật 6
	%Giải thích các giải thuật theo hướng tổng quát(15 đoạn)
%%21
%%90	


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%55
%\section{Các phương pháp gom nhóm}
%%kể ra một vài phương pháp gom nhóm: kmeans, DBScan
%
%\section{Phương pháp gom nhóm phân cấp}
%\subsection{Các hướng tiếp cận}
%\subsubsection{Hướng tiếp cận agglomerative}
%%Giới thiệu hướng tiếp cận agglomerative
%
%%Ví dụ về agglomerative
%
%\subsubsection{Hướng tiếp cận divisive}
%%Giới thiệu hướng tiếp cận divisive
%
%%Ví dụ về divisive
%
%\section{Đồng gom nhóm phân cấp}
%\subsection{Giới thiệu}
%%Điểm hạn chế về gom nhóm
%
%%Giới thiệu về đồng gom nhóm
%
%%Sự kết hợp của đồng gom nhóm phân cấp
%
%%Công dụng của đồng gom nhóm phân cấp
%
%%Giải thích việc tương tác hai chiều của dữ liệu
%
%%Kết luận về đồng gom nhóm phân cấp
%
%\subsection{Độ tương đồng Goodman Kruskal $\tau$}
%%Vì sao chọn Goodman Kruskal $\tau$
%
%%Giới thiệu Goodman Kruskal $\tau$
%
%%Luật sử dụng Goodman Kruskal $\tau$
%
%%Ví dụ về Goodman Kruskal
%
%\subsection{Thuật toán}
%%Giới thiệu thuật toán
%
%%Các giải thuật
%
